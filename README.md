# Download All Links From A Page

This repo showcase how my colleagues and I work on this site: https://www.arcweb.com/clients/reports, to get all the pdf downloaded into local device.
Due to urgency of this project, the method provided below is not optimized.

### You need: 
1. Chrome Browser
2. Chrome Extension by Nils Maier, https://chromewebstore.google.com/detail/downthemall/nljkibfhlpcnanjgbnlnbjecgicbjkge
3. HTML Editor

## A) Identify Objective
Our goal is to download all the pdf files from the web based on catogories/filter
![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/c39120bd-acdf-4a31-b59e-74c71a00d268)

## B) Problems
1. There are thousand of documents to be downloaded. 
2. The website required authentication for downloading report purposes.
3. The href links in the source code are internal links.

## C) Solution
### Step 1 - Install Chrome Extension - 'DownThemAll!' 
- Open Google Chrome
- Go to https://chromewebstore.google.com/detail/downthemall/nljkibfhlpcnanjgbnlnbjecgicbjkge and click 'Add to Chrome'.
- Click 'Add extension' in the popup.

### Step 2 - Extension Settings - 'Allow access to file URLs'
- Go to upper right corner in google chrome where there is a puzzle icon.
  
   ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/15eecfb0-3d43-46a6-91e4-5d4636e6e53a)
 
- Click three dots beside the extension.
- Click 'Manage Extension'.
  
  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/16404c8b-31fd-446d-9bed-b12ce9648f48)

- Enable 'Allow access to file URLs'
  
  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/cb730de5-e391-414f-bff3-9ec2c766425c)

### Step 3 - Create HTML lists
- Go to https://www.arcweb.com/clients/reports.
- Log in account.
- Filter files needed using filter panel on the left. Remember to click 'Apply'. 

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/e23ffb93-b30d-43e8-a397-a88cda67fee1)

- On Page 1, right click -> 'View page source'
- Scroll until you find the `<table>` tags
- Copy the whole `<table> ... </table>` tags

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/366c076f-7ee8-4dda-a492-c20e16b25c1f)

- Open HTML editor (I use _VS Code_), and then paste the code into `<body> ... </body>` from a blank HTML canvas.

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/8eca98f9-7f02-4a65-94eb-183640af4e37)

  
- Here is a blank HTML generated by ChatGPT if you need: 
  ```
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <style>
          /* Add your CSS styling here */
      </style>
  </head>
  <body>

      <!-- Add your HTML content here -->

  </body>
  </html>
  ```

- Save the file as 'Document.html'.
    
  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/39b7e149-a2b0-44f3-a8bd-726e77266317)

- Click and run the HTML file. It should be something like this:

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/0d89f85e-62d1-473c-812a-18504b2e7ff3)
- Note: the links would not work as they are internal links. See step 4.
- Copy and paste the `<table> ... </table>` for all the page after.
- Navigate the page using the button at the bottom of page.

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/57887aa6-88c8-48c0-8293-1529b5f57767)

    
### Step 4 - Convert Internal Links to External
- In the HTML editor, press `Ctrl + F` on windows.
- Search `/clients`.
- Click the down arrow on the left.
- Replace with the word `https://www.arcweb.com/clients`.
- Enter `Ctrl + Alt + Enter` to replace all. 
 
  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/797e1958-2c04-4caf-a132-da0fdeaf1016)

- `Ctrl + S` to save the file
- Reload the site and all the links should works.
    
### Step 5 - Open all the links
- Open all the links by clicking the scroll wheel on the links.

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/29633cbd-ce76-4a80-9a64-76f5d06ef5e9)

### step 6 - Download All!
- Open the extension by clicking the puzzle icon again.
  
  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/afe33fee-f2e3-4bab-a8de-21570f8c432a)

- Click 'DownThemAll! - All Tabs'. 

  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/00c0454f-5593-403d-8dc7-ee7fc37c1395)

- There will be a popup window: 
- Choose Documents (pdf, odf, docsx, ...) and untick other filters.
  
  ![image](https://github.com/CPJ03/download-all-links-from-a-page/assets/88066484/5b57a85d-c6f8-4392-a44c-5775c6553456)

- Click download and you are done! 
 
## D) Optimization
Due to short of time, this method requires my colleagues to open nearly 2000+ links in order to batch download all. 

Here is an **unfinished** HTML code that make use of `<checkbox>`, `<button>`, and `Array` to let user batch open all the links with single click. The `start` of an array and `end` of the array is determined based on the `length` which is assigned upon user checkbox selection. 
```
<script>
        const form = document.getElementById('myForm');
        let selectedOption = null;
        let length = 0;

        form.addEventListener('change', (event) => {
            if (event.target.name === 'option') {
                selectedOption = event.target.value;
                if (selectedOption === 'option1') {
                    length = 100;
                }
                if (selectedOption === 'option2') {
                    length = 200;
                }
                if (selectedOption === 'option3') {
                    length = 300;
                }
                if (selectedOption === 'option4') {
                    length = 400;
                }
                if (selectedOption === 'option5') {
                    length = 500;
                }
                if (selectedOption === 'option6') {
                    length = 600;
                }
                if (selectedOption === 'option7') {
                    length = 700;
                }
                if (selectedOption === 'option8') {
                    length = 800;
                }
            }
            
        });


        <! -- this function contain bugs which is consider 'unfinished' -->
        const downloadAll = () => {
            const allLinks = document.querySelectorAll('a');
            if (selectedOption) {
                const [start, end] = selectedOption.split('-').map(Number);
                const linksToOpen = Array.from(allLinks).slice(length - 100, length);

                linksToOpen.forEach(link => {
                    const event = new MouseEvent('click', {
                        bubbles: true,
                        cancelable: true,
                        view: window
                    });
                    link.target = '_blank'; // Ensures the link opens in a new tab
                    link.dispatchEvent(event);
                });
            } else {
                alert("Please select a range before clicking 'Open selected links'");
            }
        };
    
    </script>
```
- Click here for full code: ([link](https://github.com/CPJ03/download-all-links-from-a-page/blob/main/Unfinish%20Javascript.html))
